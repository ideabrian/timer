<!DOCTYPE html>
<html lang="fr">
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Silent Alarm</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" type="text/css" href="style.css">
        <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,700' rel='stylesheet' type='text/css'>
    </head>
    <body>
        <form>
            <fieldset>
                <input type="text" id="hours" size="1" value="00"><p>:</p>
    			<input type="text" id="minutes" size="1" value="00"><p>:</p>
    			<input type="text" id="seconds" size="1" value="03">
            </fieldset>
            <input type="submit" id="start" value="Start">
            <input type="submit" id="pause" value="Stop" class="hidden">
        </form>
        
        <script type="text/javascript">

            function getSeconds (){
                hours = parseInt(document.getElementById('hours').value);
                minutes = parseInt(document.getElementById('minutes').value);
                seconds = parseInt(document.getElementById("seconds").value);
                return (hours * 3600) + (minutes * 60) + seconds; 
            }

            function displayTime() {
                hrs = Math.floor(total / 3600);
                mins = Math.floor((total - (hrs * 3600)) / 60) ;
                secs = Math.floor(total - (hrs * 3600) - (mins * 60));
                if (mins < 10) {
                    mins = '0'+ mins;
                }
                if (secs < 10) {
                    secs = '0'+ secs;
                }
                document.getElementById('minutes').value = mins;
                document.getElementById('seconds').value = secs;

            }

            function startTimer () {
                total = getSeconds();
                start.style.display = "none";
                pause.style.display = "block";                
                if (total == 0) {
                    alert('Please enter a correct number');
                }    
                else {
                    decount();
                }      
            }

            function decount() {
                if (total > 0) {
                    total--;
                    displayTime();
                    t = setTimeout('decount()', 1000);
                }
            }

            function pauseTimer() {
                pause.style.display = "none";
                start.style.display = "block";
                clearTimeout(t);
            }

            function colorChange() {
                if (total != 0) {
                    document.body.style.webkitAnimationDuration = total + 1 + "s"; // pour eviter bug
                    document.body.style.animationDuration = total + 1 + "s"; // pour eviter bug
                }
            }
            start = document.getElementById('start');
            pause = document.getElementById('pause');
            start.addEventListener('click', startTimer, false);
            start.addEventListener('click', colorChange, false);
            pause.addEventListener('click', pauseTimer, false);
            
            //Experiments for auto prefix
            //Taken from http://www.sitepoint.com/css3-animation-javascript-event-handlers/
            var anim = document.body;

            // button click event
            start.addEventListener("click", ToggleAnimation, false);
            pause.addEventListener("click", ToggleAnimation, false);

            // start/stop animation
            function ToggleAnimation(e) {
                var on = (anim.className != "");
                anim.className = (on ? "" : "enable");
                if (e) e.preventDefault();
            };

        </script>
    </body>
</html>