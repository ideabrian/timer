<!DOCTYPE html>
<html lang="fr">
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Silent Counter</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" type="text/css" href="style.css">
        <link href='http://fonts.googleapis.com/css?family=Open+Sans:300' rel='stylesheet' type='text/css'>
    </head>
    <body>
        <form>
            <fieldset>
                <input type="text" id="hour" size="2" value="00"><p>:</p>
    			<input type="text" id="minutes" size="2" value="00"><p>:</p>
    			<input type="text" id="seconds" size="2" value="03">
            </fieldset>
            <input type="submit" id="start" value="Start">
            <input type="submit" id="pause" value="Stop">
        </form>
        
        <script type="text/javascript">

            function getSeconds (){
                minutes = parseInt(document.getElementById('minutes').value);
                seconds = parseInt(document.getElementById("seconds").value);
                return (minutes * 60) + seconds; 
            }

            function displayTime() {
                mins = Math.floor(total / 60);
                secs = Math.floor(total - (mins * 60));
                if (mins < 10) {
                    mins = '0'+ mins;
                }
                if (secs < 10) {
                    secs = '0'+ secs;
                }
                document.getElementById('minutes').value = mins;
                document.getElementById('seconds').value = secs;

            }

            function startTimer () {
                total = getSeconds();
                if (total > 0) {
                    total--;
                    displayTime();
                    t = setTimeout('startTimer()', 1000);
                }             
            }

            function pauseTimer() {
                clearTimeout(t);
            }

            function colorChange() {
                document.body.style.webkitAnimationDuration = total + 1 + "s";
            }
            start = document.getElementById('start');
            pause = document.getElementById('pause');
            start.addEventListener('click', startTimer, false);
            start.addEventListener('click', colorChange, false);
            pause.addEventListener('click', pauseTimer, false);
            
            //Experiments for auto prefix
            //Taken from http://www.sitepoint.com/css3-animation-javascript-event-handlers/
            var 
                anim = document.body,
                pfx = ["webkit", "moz", "MS", "o", ""];

            // button click event
            start.addEventListener("click", ToggleAnimation, false);
            pause.addEventListener("click", ToggleAnimation, false);

            /*Unnecessary
            // animation listener events
            //PrefixedEvent(anim, "AnimationDuration", AnimationListener);

            
            // apply prefixed event handlers
            function PrefixedEvent(element, type, callback) {
                for (var p = 0; p < pfx.length; p++) {
                    if (!pfx[p]) type = type.toLowerCase();
                    element.addEventListener(pfx[p]+type, callback, false);
                }
            }

            // handle animation events
            function AnimationListener(e) {
                if (e.type.toLowerCase().indexOf("animationend") >= 0) {
                    ToggleAnimation();
                }
            }*/

            // start/stop animation
            function ToggleAnimation(e) {
                var on = (anim.className != "");
                anim.className = (on ? "" : "enable");
                if (e) e.preventDefault();
            };

        </script>
    </body>
</html>